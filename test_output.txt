
> asset-manager-gas@1.0.0 test
> jest tests/aggregation.test.js

  console.log
    Aggregated Stock Risk: {
      label: '?湔蝬剜???,
      value: '48.18%',
      status: 'Danger',
      rawRatio: 48.18181818181818
    }

      at Object.log (tests/aggregation.test.js:37:17)

FAIL tests/aggregation.test.js
  Aggregation Logic Tests
    ? Stock Aggregation: Multiple Positions -> One Ratio (17 ms)
    ? Backward Compatibility: Single Position Transform

  ??Aggregation Logic Tests ??Stock Aggregation: Multiple Positions -> One Ratio

    expect(received).toBe(expected) // Object.is equality

    Expected: "嚙踝蕭嚙踝蕭嚙踝蕭嚙緞"
    Received: "?湔蝬剜???

      36 |
      37 |         console.log('Aggregated Stock Risk:', aggRisk);
    > 38 |         expect(aggRisk.label).toBe('嚙踝蕭嚙踝蕭嚙踝蕭嚙緞');
         |                               ^
      39 |         expect(Number(parseFloat(aggRisk.value))).toBeCloseTo(134.09, 1);
      40 |         expect(aggRisk.status).toBe('Safe');
      41 |     });

      at Object.toBe (tests/aggregation.test.js:38:31)

  ??Aggregation Logic Tests ??Backward Compatibility: Single Position Transform

    expect(received).toBe(expected) // Object.is equality

    Expected: "嚙踝蕭嚙踝蕭嚙踝蕭嚙緞"
    Received: "?湔蝬剜???

      50 |
      51 |         const risk = RiskCalculator.transform(pos, marketData);
    > 52 |         expect(risk.label).toBe('嚙踝蕭嚙踝蕭嚙踝蕭嚙緞'); // Now defaults to aggregated label
         |                            ^
      53 |         expect(Number(parseFloat(risk.value))).toBeCloseTo(1000.00);
      54 |     });
      55 |

      at Object.toBe (tests/aggregation.test.js:52:28)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 2 total
Snapshots:   0 total
Time:        0.41 s, estimated 1 s
Ran all test suites matching /tests\\aggregation.test.js/i.
